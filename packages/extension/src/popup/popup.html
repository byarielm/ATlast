<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ATlast Importer</title>
        <link rel="stylesheet" href="popup.css" />
    </head>
    <body
        class="w-[350px] min-h-[400px] font-sans bg-gradient-to-br from-cyan-50 via-purple-50 to-pink-50 dark:from-indigo-950 dark:via-purple-900 dark:to-slate-900 text-slate-900 dark:text-slate-100 transition-colors duration-300 text-1xl font-bold mb-2 text-center"
    >
        <div class="flex flex-col min-h-[400px]">
            <header class="bg-firefly-banner text-white p-5 text-center">
                <h1 class="text-xl font-bold mb-1">ATlast Importer</h1>
                <p class="text-[13px] opacity-90">
                    Find your follows in the ATmosphere
                </p>
            </header>

            <main
                id="app"
                class="flex-1 px-5 py-6 flex items-center justify-center"
            >
                <!-- Idle state -->
                <div id="state-idle" class="w-full text-center hidden">
                    <div class="text-5xl mb-4">üîç</div>
                    <p
                        class="text-base font-semibold mb-3 text-slate-700 dark:text-cyan-50"
                    >
                        Go to your Twitter/X Following page to start
                    </p>
                    <p
                        class="text-[13px] text-slate-500 dark:text-slate-400 mt-2"
                    >
                        Visit x.com/yourusername/following
                    </p>
                </div>

                <!-- Ready state -->
                <div id="state-ready" class="w-full text-center hidden">
                    <div class="text-5xl mb-4">‚úÖ</div>
                    <p
                        class="text-base font-semibold mb-3 text-slate-700 dark:text-cyan-50"
                    >
                        Ready to scan <span id="platform-name"></span>
                    </p>
                    <button
                        id="btn-start"
                        class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg mt-4 transition-all duration-200 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-orange-600/30 active:translate-y-0"
                    >
                        Start Scan
                    </button>
                </div>

                <!-- Scraping state -->
                <div id="state-scraping" class="w-full text-center hidden">
                    <div class="text-5xl mb-4 spinner">‚è≥</div>
                    <p
                        class="text-base font-semibold mb-3 text-slate-700 dark:text-cyan-50"
                    >
                        Scanning...
                    </p>
                    <div class="mt-5">
                        <div
                            class="w-full h-2 bg-sky-50 dark:bg-slate-800 rounded overflow-hidden mb-3"
                        >
                            <div
                                id="progress-fill"
                                class="h-full bg-gradient-to-r from-orange-600 to-pink-600 w-0 transition-all duration-300 progress-fill"
                            ></div>
                        </div>
                        <p
                            class="text-base font-semibold text-slate-700 dark:text-cyan-50"
                        >
                            Found <span id="count">0</span> users
                        </p>
                        <p
                            id="status-message"
                            class="text-[13px] text-slate-500 dark:text-slate-400 mt-2"
                        ></p>
                    </div>
                </div>

                <!-- Complete state -->
                <div id="state-complete" class="w-full text-center hidden">
                    <div class="text-5xl mb-4">üéâ</div>
                    <p
                        class="text-base font-semibold mb-3 text-slate-700 dark:text-cyan-50"
                    >
                        Scan complete!
                    </p>
                    <p class="text-sm text-slate-500 dark:text-slate-400 mt-2">
                        Found
                        <strong
                            id="final-count"
                            class="text-orange-600 dark:text-orange-400 text-lg"
                            >0</strong
                        >
                        users
                    </p>
                    <button
                        id="btn-upload"
                        class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg mt-4 transition-all duration-200 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-orange-600/30 active:translate-y-0"
                    >
                        Open in ATlast
                    </button>
                </div>

                <!-- Uploading state -->
                <div id="state-uploading" class="w-full text-center hidden">
                    <div class="text-5xl mb-4 spinner">üì§</div>
                    <p
                        class="text-base font-semibold mb-3 text-slate-700 dark:text-cyan-50"
                    >
                        Uploading to ATlast...
                    </p>
                </div>

                <!-- Error state -->
                <div id="state-error" class="w-full text-center hidden">
                    <div class="text-5xl mb-4">‚ö†Ô∏è</div>
                    <p
                        class="text-base font-semibold mb-3 text-slate-700 dark:text-cyan-50"
                    >
                        Error
                    </p>
                    <p
                        id="error-message"
                        class="text-[13px] text-red-600 dark:text-red-400 mt-2 p-3 bg-red-50 dark:bg-red-950/50 rounded border-l-[3px] border-red-600"
                    ></p>
                    <button
                        id="btn-retry"
                        class="w-full bg-white dark:bg-purple-950 text-purple-700 dark:text-cyan-400 border-2 border-purple-700 dark:border-cyan-400 font-semibold py-2.5 px-6 rounded-lg mt-4 transition-all duration-200 hover:bg-purple-50 dark:hover:bg-purple-900"
                    >
                        Try Again
                    </button>
                </div>

                <!-- Server offline state -->
                <div id="state-offline" class="w-full text-center hidden">
                    <div class="text-5xl mb-4">üîå</div>
                    <p
                        class="text-base font-semibold mb-3 text-slate-700 dark:text-cyan-50"
                    >
                        Server not available
                    </p>
                    <p
                        id="dev-instructions"
                        class="text-[13px] text-red-600 dark:text-red-400 mt-2 p-3 bg-red-50 dark:bg-red-950/50 rounded border-l-[3px] border-red-600"
                    >
                        Start the dev server:<br />
                        <code
                            class="bg-black/10 dark:bg-white/10 px-2 py-1 rounded font-mono text-[11px] inline-block my-2"
                            >npx netlify-cli dev --filter @atlast/web</code
                        >
                    </p>
                    <p
                        class="text-[13px] text-slate-500 dark:text-slate-400 mt-2"
                        id="server-url"
                    ></p>
                    <button
                        id="btn-check-server"
                        class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg mt-4 transition-all duration-200 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-orange-600/30 active:translate-y-0"
                    >
                        Check Again
                    </button>
                </div>

                <!-- Not logged in state -->
                <div id="state-not-logged-in" class="w-full text-center hidden">
                    <div class="text-5xl mb-4">üîê</div>
                    <p
                        class="text-base font-semibold mb-3 text-slate-700 dark:text-cyan-50"
                    >
                        Not logged in to ATlast
                    </p>
                    <p
                        class="text-[13px] text-red-600 dark:text-red-400 mt-2 p-3 bg-red-50 dark:bg-red-950/50 rounded border-l-[3px] border-red-600"
                    >
                        Please log in to ATlast first, then return here to scan.
                    </p>
                    <button
                        id="btn-open-atlast"
                        class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg mt-4 transition-all duration-200 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-orange-600/30 active:translate-y-0"
                    >
                        Open ATlast
                    </button>
                    <button
                        id="btn-retry-login"
                        class="w-full bg-white dark:bg-purple-950 text-purple-700 dark:text-cyan-400 border-2 border-purple-700 dark:border-cyan-400 font-semibold py-2.5 px-6 rounded-lg mt-4 transition-all duration-200 hover:bg-purple-50 dark:hover:bg-purple-900"
                    >
                        Check Again
                    </button>
                </div>
            </main>

            <footer
                class="p-4 text-center border-t border-purple-200 dark:border-slate-800 bg-white dark:bg-slate-900"
            >
                <a
                    href="https://atlast.byarielm.fyi"
                    target="_blank"
                    class="text-orange-600 dark:text-orange-400 no-underline text-[13px] font-medium hover:underline"
                    >atlast.byarielm.fyi</a
                >
            </footer>
        </div>

        <script type="module" src="popup.js"></script>
    </body>
</html>
